SELECT EMPLOYEE_ID , (FIRST_NAME || ' ' || LAST_NAME) AS "FULL NAME", DEPARTMENT_ID, (SALARY+SALARY*(NVL(COMMISSION_PCT,0))) AS "TOTAL MONTHLY SALARY"
FROM EMPLOYEES
WHERE FIRST_NAME LIKE 'D%' AND LAST_NAME LIKE '___n%' AND DEPARTMENT_ID BETWEEN 20 AND 70;


SELECT JOB_ID
FROM EMPLOYEES
WHERE (SYSDATE-HIRE_DATE)<=1500
GROUP BY JOB_ID 
HAVING COUNT(*)>=2;



SELECT DEPARTMENT_ID, MIN(SALARY), MAX(SALARY), ROUND(AVG(SALARY),4) AS "AVERAGE SALARY"
FROM EMPLOYEES
WHERE DEPARTMENT_ID <> 50
GROUP BY DEPARTMENT_ID
ORDER BY MAX(SALARY)-MIN(SALARY) DESC, ROUND(AVG(SALARY),4) ASC;


SELECT MANAGER_ID, COUNT(EMPLOYEE_ID)
FROM EMPLOYEES
GROUP BY MANAGER_ID 
HAVING COUNT(EMPLOYEE_ID)<10 AND AVG(SALARY)<4000
ORDER BY COUNT(EMPLOYEE_ID), AVG(SALARY) ASC;

SELECT LAST_NAME FROM EMPLOYEES
WHERE MOD(LENGTH(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(UPPER(LAST_NAME),'A',''),'E',''),'I',''),'O',''),'U','')),2) = 1;

